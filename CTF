##############################################################DAY 1##############################################################
###############################PRIMER QUESTIONS###############################
PRIMER #1
Which program starts with every CMD and PowerShell instance in Windows 7 and later?
conhost.exe


PRIMER #2
What Windows 10 feature supports installing Linux subsystem?
WSL


PRIMER #3
Which Windows feature can be used to interact with any CLI on the Windows system concurrently using multiple tabs?
windows terminal

PRIMER #4
What was the default shell (command line) of Windows versions Windows 2000 through Windows 8.1?
cmd.exe

PRIMER #5
What data type do all cmd.exe commands return?
string

PRIMER #6
What framework is PowerShell built on?
.net

PRIMER #7
"What will all of the below give you?

(get-host).version

$host.version

$psversiontable.psversion"
Powershell version



PRIMER #8
After PowerShell Core is installed what CLI command launches it?
pwsh.exe

PRIMER #9
"After PowerShell Core is installed you can still run the built in version of PowerShell side-by-side. 
What CLI command will launch the built in version?"
powershell.exe


###############################END###############################
###############################POWER SHELL QUESTIONS###############################
#1
Windows_PowerShell_Basics1
What syntax do PowerShell cmdlets follow?
verb-noun

#2
Windows_PowerShell_Basics2
What PS command will list all PowerShell cmdlets?
get-command

#3
Windows_PowerShell_Basics3
What PowerShell command will list all verbs?
get-verb

#4
Windows_PowerShell_Basics4
BASH commands output strings. PowerShell commands output what data type?
objects

#5
Windows_PowerShell_Basics5
All PowerShell objects are comprised of what two things?
Flag format: things,things
properties, methods
#6
Windows_PowerShell_Basics6
What command will list all things that make up a PowerShell object?
get-member

#7
Windows_PowerShell_Alias1
What PowerShell command will list PowerShell aliases?
get-alias

#8
Windows_PowerShell_Alias2
What PowerShell command lists all of the contents of a directory?
get-childitem


#9
Windows_PowerShell_Help1
What is the basic cmdlet that displays help about Windows Powershell cmdlets and concepts?
get-help


#10
Windows_PowerShell_Help2
PowerShell "help files" don't show the entire help file with a basic command. What switch option shows the entire help file?
-full

#11
Windows_PowerShell_Help3
What PowerShell command will update the PowerShell "help files" to the latest version?
update-help

#12
Windows_PowerShell_Help 4
What help switch will show you the "help files" on Microsoft's website, in your default browser?
-online

#13
Windows_PowerShell_Interaction1
What command will start the Chrome browser on your machine?
start chrome

#14
Windows_PowerShell_Interaction2
What command using a PS Method will stop chrome?
Flag is the full command.
(get-process chrome).kill()

#15
Windows_PowerShell_Interaction3
What PowerShell command (without using a method) will stop the Chrome process?
stop-process -name chrome


#16
Windows_PowerShell_CimClasses1
PowerShell doesn't have a native cmdlet that will give you processor information (such as get-processor or get-cpu). 
Knowing this information might be necessary. What command would give you information about the system's processor?
Flag is the full command
Get-WmiObject Win32_Processor


#17
Windows_PowerShell_Logic1
What PowerShell command will read a text file?
get-content

#18
Windows_PowerShell_Logic2
What PowerShell command will allow for counting lines in a file, averaging numbers, and summing numbers?
measure-object


#19
Windows_PowerShell_Regex_1
What PowerShell command searches for text patterns in a string?
select-string


#20
Windows_PowerShell_Basics_7
Users' files are stored in their corresponding home directory. What is the literal path to all home directories on a Windows 10 system?
C:\users\


#21
Windows_PowerShell_Basics_8
How many properties are available for the get-process cmdlet?
Note: Property values only
(get-process | get-member -membertype property).count
52

#22
Windows_PowerShell_Alias3
How many aliases does PowerShell have for listing the contents of a directory?
3

#23
Windows_PowerShell_Help 5
When requesting the help file for the get-process cmdlet, what full command is the 9th example given?
get-process powershell

#24
Windows_PowerShell_CimClasses2
To complete this challenge, find the description of the Lego Land service.
Reminder: All challenges are done using the file-server.
Get-WmiObject win32_servie | ?{$_.Name -like "Legoland"} | select Description
i_love_legos

#25
Windows_PowerShell_Logic3
In the CTF folder on the CTF User's Desktop, count the number of words in words2.txt.
get-content words2.txt | measure-object -word
5254 words


#26
Windows_PowerShell_Logic4
Count the number of files in the Videos folder in the CTF user's home directory.
(get-childitem | measure-object).count
925 files

#27
Windows_PowerShell_Logic5
Find the only line that makes the two files in the CTF user's Downloads folder different.
Hint The flag is the string (not line number).
compare-object -referenceobject (get-content old.txt) -differenceobject (get-content new.txt)
popeye

#28
Windows_PowerShell_Logic6
The password is the 21st line from the top, in ASCII alphabetically-sorted, descending order of the words.txt file.
**Note: File Location - C:\Users\CTF\Desktop\CTF
get-content words.txt | sort-object -descending | select-object -index 21
ZzZp

#29
Windows_PowerShell_Logic7
Count the number of unique words in words.txt
**Note: File Location - C:\Users\CTF\Desktop\CTF
(get-content words.txt | sort-object | get-unique).count
456976

#30
Windows_PowerShell_Basics_9
How many methods are available for the get-process cmdlet?
Machine: Admin_Station
(get-process | get-member -membertype method).count

#31
Windows_Powershell_Logic_8
Count the number of folders in the Music folder in the CTF user’s profile.
(get-childitem -recurse | where-object {$_.PSIsContainer}).count
411

#32
Windows_PowerShell_Regex_2
Count the number of times, case-insensitive, gaab is listed in words.txt **Note: File Location - C:\Users\CTF\Desktop\CTF
(get-content words.txt | select-string -allmatches "gaab").count
1

#33
Windows_PowerShell_Regex_3
Count the number of words, case-insensitive, with either a or z in a word, in the words.txt file
Note: File Location - C:\Users\CTF\Desktop\CTF
(get-content words.txt | where-object { $_ -match '(a|z)'}).count
160352

#34
Windows_PowerShell_Regex_4
Count the number of lines, case-insensitive, that a or z appears in the words.txt file
Note: File Location - C:\Users\CTF\Desktop\CTF
(get-content words.txt | where-object { $_ -match '(az)'}).count
2754

#35
Windows_PowerShell_Logic_9
Use a PowerShell loop to unzip the Omega file 1,000 times and read what is inside.
Note: Make sure you back up the .zip file to a different directory before attempting this challenge.
for($i=1000;$i -gt 0; $i--){expand-archive -path ".\omega${i}.zip";mv "omega${i}\omega$($i-1).zip"}
expand-archive .\omega1.zip
cd omega1
expand-archive.\omega1.zip
cd omega1
get-content .\omega1.txt
kung-fu

#36
Windows_PowerShell_Regex_5
Count the number of words in words.txt that meet the following criteria:
a appears at least twice consecutively
and is followed immediately by any of the letters a through g
Note: File Location - C:\Users\CTF\Desktop\CTF
Example: aac...aaa...
(get-content words.txt | where-object { $_ -match '((aa)[a-g])}).count
357

###############################END###############################
###############################POWERSHELL_PROFILES###############################
#1
Windows_PowerShell_Profiles1
Which PowerShell profile has the lowest precedence?
Current User, Current Host


#2
Windows_PowerShell_Profiles2
Which PowerShell profile has the highest precedence?
All Users, All Hosts

#3
Windows_PowerShell_Profiles3
Which PowerShell variable stores the current user’s home directory?
$HOME

#4
Windows_PowerShell_Profiles4
Which PowerShell variable stores the installation directory for PowerShell?
$PsHome

#5
Windows_PowerShell_Profiles5
Which PowerShell variable stores the path to the "Current User, Current Host" profile?
$Profile

#6
Windows_PowerShell_Profiles6
What command would you run to view the help for PowerShell Profiles?


#7

#8



###############################END###############################
##############################################################END OF DAY 1##############################################################
##############################################################DAY 2##############################################################
###############################REGISTRY PRIMER###############################
#1
Primer_Registry_1
What Windows registry path is the Volatile Hive?
HKLM\HARDWARE

#2
Primer_Registry_2
What registry key creates the Wow6432Node to represent 32-bit applications that run on a 64-bit version of Windows?
HKEY_LOCAL_MACHINE\SOFTWARE


#3
Primer_Registry_3
In what registry path are the BOOT_START drivers located?
HKLM\SYSTEM\CurrentControlSet\Services

#4
Primer_Registry_4
What start value do BOOT_START drivers have in the registry?
0x0


#5
Primer_Registry_5
During kernel initialization, what registry location is read containing all SYSTEM_START drivers?
HKLM\SYSTEM\CurrentControlSet\Services


#6
Primer_Registry_6
SERVICE_AUTO_START drivers and services are loaded after kernel initialization. What start value do they have in the registry?
0x02


#7
Primer_Registry_7
What start value do SERVICE_DEMAND_START drivers and services have in the registry?
0x3

#8
Primer_Registry_8
When accessing a remote registry which are the only 2 accessible HKEYs?
SYNTAX Hive, Hive
HKLM, HKU

#9
Primer_Registry_9
What PowerShell cmdlet will list currently mapped drives?
get-psdrive


#10
Primer_Registry_10
What is the native Windows GUI tool for managing the registry?
regedit

###############################END###############################
###############################REGISTRY###############################
#1
Windows_Registry_Basics_1
What registry hive contains all machine settings?
HKLM

#2
Windows_Registry_Basics_2
What registry hive contains all user settings?
HKU

#3
Windows_Registry_Basics_3
What registry hive contains only the currently logged-in user's settings?
HKCU

#4
Windows_Registry_Basics_4
The HKEY_CURRENT_USER registry hive is a symbolic link to another registry subkey. What is the subkey that it is linked to?
Flag format: HIVE\SID.........................
Reminder: All challenges are done using Workstation2.
reg query HKU
HKEY_USERS\S-1-5-21-2881336348-3190591231-4063445930-1002

#5
Windows_Registry_Basics_5
What PowerShell command will list all the subkeys and contents in the current directory and/or will list all the subkeys and 
the contents of a directory you specify?
get-childitem


#6
Windows_Registry_Basics_6
What PowerShell command will list only the contents of a registry key or subkey?
get-item


#7
Windows_Registry_Basics_7
What registry subkey runs every time the machine reboots? The flag is the full path, using PowerShell.
Flag format: FULL\PATH\ALL\CAPS
HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUN


#8
Windows_Registry_Basics_8
What registry subkey runs every time a user logs on? The flag is the full path, using PowerShell.
Flag format: FULL\PATH\ALL\CAPS
HKEY_CURRENT_USER\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUN


#9
Windows_Registry_Basics_9
What registry subkey runs a single time, then deletes its value once the machine reboots? The flag is the full path, using PowerShell.
Flag format: FULL\PATH\ALL\CAPS
HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUNONCE


#10
Windows_Registry_Basics_10
What registry subkey runs a single time, then deletes its value when a user logs on? The flag is the full path, using PowerShell.
Flag format: FULL\PATH\ALL\CAPS
HKEY_CURRENT_USER\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUNONCE


#11

#12

#13

#14

#15

#16

#17

###############################END###############################
###############################NTFS PRIMER###############################
#1
Primer_NTFS_1
The ____ determines how the data is stored on disk.
format

#2
Primer_NTFS_2
What are NTFS partition sectors grouped into?
cluster


#3
Primer_NTFS_3
What contains the metadata about all of the files and directories on a NTFS partition?
MFT

#4
Primer_NTFS_4
NTFS files are collections of what?
attributes

#5
Primer_NTFS_5
Which NTFS attribute would store an alternate data stream?
$DATA


#6
Primer_NTFS_6
Which NTFS attribute holds information about a file's encrypted attributes?
$LOGGED_UTILITY_STREAM

#7
Primer_NTFS_7
Which NTFS attribute that is composed of the file security and access control properties?
$SECURITY_DESCRIPTOR

#8
Primer_NTFS_8
In NTFS, what is the type id, in hex, of the attribute that actually stores a NTFS files contents?
0x80

#9
Primer_NTFS_9
In NTFS what is the maximum number of bytes a MFT entry (containing the entirety of a file) 
can contain to be considered "Resident Data"?
1024

#10
Primer_NTFS_10
NTFS permissions can be a assigned to a filesystem object in two ways. Which way is intentionally assigned on the file or folder?
explicit

#11
Primer_NTFS_11
NTFS permissions can be a assigned to a filesystem object in two ways. Which way is the results of an object being assigned permissions
as the result of being the child of another object?
inherited

#12
Primer_NTFS_12
Which NTFS file level permission is missing from the following list? Write, Read & Execute, Modify, Full Control
read

#13
Primer_NTFS_13
Which NTFS folder level permission is missing from the following list?: Read, Write, Read & Execute, Modify, Full control
List Folder Contents

#14
Primer_NTFS_14
Which NTFS file level permission permits changing the contents of a file, deleting the file but does not allow the ability to change the permissions on the file?
modify

#15
Primer_NTFS_15
Which NTFS folder level permission allows changing permissions?
full control

#16
Primer_NTFS_16
Which NTFS attribute stores the file times of an object?
$STANDARD_INFORMATION

#17
Primer_NTFS_17
What CLI command will only show the letters of attached drives? **Hint command is 3 words
fsutil fsinfo drives
###############################END###############################
###############################NTFS###############################

#18
Windows_File_System_Basics_1
Every file on a Windows system has attributes. What does the d attribute mean?
directory

#19
Windows_File_System_Basics_2
Every file on a Windows system has attributes. What does the h attribute mean?
hidden

#20
Windows_File_System_Basics_3
What PowerShell command will list all files in the current directory, regardless of their attributes?
get-childitem -force

#21
Windows_File_System_Basics_4
What PowerShell command will give you the sha512 hash of a file?
Flag format: command -argument
get-filehash -algorithm sha512

#22
Windows_File_System_Basics_5
What PowerShell command will list permissions of a file?
get-acl

#23
Windows_File_System_Basics_6
What Windows file maps hostnames to IP addresses?


#24

#25

#26

#27

#28

#29

#30

#31


###############################END###############################
##############################################################END OF DAY 2##############################################################
##############################################################DAY 3##############################################################
###############################LINUX BASICS###############################
#1
Linux Basics Reformat0
This challenge is worth 0 POINTS, and should only be attempted after all other challenges that are open to you, are completed!

File: /home/garviel/NMAP_all_hosts.txt

Format the file into the output displayed below using native Linux binaries like awk.


Service: ident Count: 1
==============================
192.168.33.236

Service: IIS Count: 3
==============================
192.168.33.205
192.168.33.227
192.168.33.229

--TRIMMED--
Present the script used to the instructor for credit when complete. Be prepared to explain the code.

HINT: awk is a powerful text manipulation scripting language. It is a bit challenging to learn. Use the tutorials below to get started.

Awk - A Tutorial and Introduction - by Bruce Barnett

The GNU Awk User’s Guide



#2
Linux Basics 1
What command lists the contents of directories in Linux/Unix systems?
ls

#3
Linux Basics 2
For the ls command, what arguments, or switch options, will allow you to print human-readable 
file sizes in a long-list format?
The flag is entire command, including arguments
ls -lh

#4
Linux Basics 3
What character will pipe the standard output from
echo "I’m a plumber"
to another command, as standard input?
|

#5
Linux Basics 4
What argument/switch option, when used with man, will search the short descriptions and man-page-names for a 
keyword that you provide?
The flag is the complete command, with argument/switch.
man -k

#6
Linux Basics LFS Hierarchy
What is the absolute path to the root directory?
/

#7
Linux Basics LFS Hierarchy2
What is the absolute path to the default location for configuration files?
/etc

#8
Linux Basics LFS Hierarchy3
What is the directory that contains executable programs (binaries) which are needed in single user mode, 
to bring the system up or to repair it?
/bin

#9
Linux Basics LFS Hierarchy4
What is the absolute path to the directory which contains non-essential binaries that are accessible 
by standard users as well as root?
/usr/bin


#10
Linux Basics LFS Hierarchy5
An absolute path to a directory which contains binaries only accessible by the root user, or 
users in the root group.
/usr/sbin

#11
Linux Basics LFS Hierarchy6
What is the absolute path for the binary cat man-page?
/usr/share/man/man1/cat.1.gz

#12
Linux Basics 5
Search the man pages for the keyword digest. 
Then, use one of the binaries listed to hash the string OneWayBestWay using the largest sha hash available.
The resulting hash is the flag.
man-k digest
man -k digest
echo "OneWayBestWay" | sha512sum
a81bc463469ee1717fc9e388e3799c653f63a3de5e9496b5707b56488b046cbf75665235d316c5c0053a597dc7d40c917a2d9006fe35e9cb47766c05ac71989b
#13
Linux Basics 6
Use File: /home/garviel/Encrypted
This file contains encrypted contents. Identify its file type, then decode its contents.
Hint: Use OpenSSL
Research: https://www.openssl.org/docs/man1.1.1/man1/enc.html
Reminder: All challenges are done using the Terra box.

#14
Linux Basics LFS Hierarchy7
Search the user home directories to find the file with the second-most lines in it. 
The flag is the number of lines in the file.
Hint: Exclude the VDI file!
find $HOME/* -type f -exec wc -l {} + | sort -rn
20000

#15
Linux Basics Users and Groups1
Read the file that contains the user database for the machine. Identify a strange comment.
awk -F: '$3 >= 1000 && $3 != 65534 { printf "%s -- %s\n",$1,$5;}' /etc/passwd
Traitor

#16
Linux Basics Users and Groups2
Identify all members of the lodge group. List their names in alphabetical order with a comma in between each name.
Flag Format: name,name,name
cat /etc/group | grep lodge | cut -d : -f 4
#put in alphabetical order
garviel,tarik,aximand,ezekyle,sejanus,erebus

#17
Linux Basics Users and Groups3
Find the user with a unique login shell.


#18

#19

#20

###############################END###############################
###############################BLANK###############################
#1
#2
#3
#4
#5
#6
#7
#8
#9
#10
#11
#12
#13
#14
#15
#16
#17
#18
#19
#20
###############################END###############################
###############################BLANK###############################
#1
#2
#3
#4
#5
#6
#7
#8
#9
#10
#11
#12
#13
#14
#15
#16
#17
#18
#19
#20
###############################END###############################
##############################################################END OF DAY 3##############################################################






###############################BLANK###############################
###############################END###############################

##############################################################DAY 1##############################################################
##############################################################END OF DAY 1##############################################################


#1
#2
#3
#4
#5
#6
#7
#8
#9
#10
#11
#12
#13
#14
#15
#16
#17
#18
#19
#20
