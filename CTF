##############################################################DAY 1##############################################################
###############################PRIMER QUESTIONS###############################
PRIMER #1
Which program starts with every CMD and PowerShell instance in Windows 7 and later?
conhost.exe


PRIMER #2
What Windows 10 feature supports installing Linux subsystem?
WSL


PRIMER #3
Which Windows feature can be used to interact with any CLI on the Windows system concurrently using multiple tabs?
windows terminal

PRIMER #4
What was the default shell (command line) of Windows versions Windows 2000 through Windows 8.1?
cmd.exe

PRIMER #5
What data type do all cmd.exe commands return?
string

PRIMER #6
What framework is PowerShell built on?
.net

PRIMER #7
"What will all of the below give you?

(get-host).version

$host.version

$psversiontable.psversion"
Powershell version



PRIMER #8
After PowerShell Core is installed what CLI command launches it?
pwsh.exe

PRIMER #9
"After PowerShell Core is installed you can still run the built in version of PowerShell side-by-side. 
What CLI command will launch the built in version?"
powershell.exe


###############################END###############################
###############################POWER SHELL QUESTIONS###############################
#1
Windows_PowerShell_Basics1
What syntax do PowerShell cmdlets follow?
verb-noun

#2
Windows_PowerShell_Basics2
What PS command will list all PowerShell cmdlets?
get-command

#3
Windows_PowerShell_Basics3
What PowerShell command will list all verbs?
get-verb

#4
Windows_PowerShell_Basics4
BASH commands output strings. PowerShell commands output what data type?
objects

#5
Windows_PowerShell_Basics5
All PowerShell objects are comprised of what two things?
Flag format: things,things
properties, methods
#6
Windows_PowerShell_Basics6
What command will list all things that make up a PowerShell object?
get-member

#7
Windows_PowerShell_Alias1
What PowerShell command will list PowerShell aliases?
get-alias

#8
Windows_PowerShell_Alias2
What PowerShell command lists all of the contents of a directory?
get-childitem


#9
Windows_PowerShell_Help1
What is the basic cmdlet that displays help about Windows Powershell cmdlets and concepts?
get-help


#10
Windows_PowerShell_Help2
PowerShell "help files" don't show the entire help file with a basic command. What switch option shows the entire help file?
-full

#11
Windows_PowerShell_Help3
What PowerShell command will update the PowerShell "help files" to the latest version?
update-help

#12
Windows_PowerShell_Help 4
What help switch will show you the "help files" on Microsoft's website, in your default browser?
-online

#13
Windows_PowerShell_Interaction1
What command will start the Chrome browser on your machine?
start chrome

#14
Windows_PowerShell_Interaction2
What command using a PS Method will stop chrome?
Flag is the full command.
(get-process chrome).kill()

#15
Windows_PowerShell_Interaction3
What PowerShell command (without using a method) will stop the Chrome process?
stop-process -name chrome


#16
Windows_PowerShell_CimClasses1
PowerShell doesn't have a native cmdlet that will give you processor information (such as get-processor or get-cpu). 
Knowing this information might be necessary. What command would give you information about the system's processor?
Flag is the full command
Get-WmiObject Win32_Processor


#17
Windows_PowerShell_Logic1
What PowerShell command will read a text file?
get-content

#18
Windows_PowerShell_Logic2
What PowerShell command will allow for counting lines in a file, averaging numbers, and summing numbers?
measure-object


#19
Windows_PowerShell_Regex_1
What PowerShell command searches for text patterns in a string?
select-string


#20
Windows_PowerShell_Basics_7
Users' files are stored in their corresponding home directory. What is the literal path to all home directories on a Windows 10 system?
C:\users\


#21
Windows_PowerShell_Basics_8
How many properties are available for the get-process cmdlet?
Note: Property values only
(get-process | get-member -membertype property).count
52

#22
Windows_PowerShell_Alias3
How many aliases does PowerShell have for listing the contents of a directory?
3

#23
Windows_PowerShell_Help 5
When requesting the help file for the get-process cmdlet, what full command is the 9th example given?
get-process powershell

#24
Windows_PowerShell_CimClasses2
To complete this challenge, find the description of the Lego Land service.
Reminder: All challenges are done using the file-server.
Get-WmiObject win32_servie | ?{$_.Name -like "Legoland"} | select Description
i_love_legos

#25
Windows_PowerShell_Logic3
In the CTF folder on the CTF User's Desktop, count the number of words in words2.txt.
get-content words2.txt | measure-object -word
5254 words


#26
Windows_PowerShell_Logic4
Count the number of files in the Videos folder in the CTF user's home directory.
(get-childitem | measure-object).count
925 files

#27
Windows_PowerShell_Logic5
Find the only line that makes the two files in the CTF user's Downloads folder different.
Hint The flag is the string (not line number).
compare-object -referenceobject (get-content old.txt) -differenceobject (get-content new.txt)
popeye

#28
Windows_PowerShell_Logic6
The password is the 21st line from the top, in ASCII alphabetically-sorted, descending order of the words.txt file.
**Note: File Location - C:\Users\CTF\Desktop\CTF
get-content words.txt | sort-object -descending | select-object -index 21
ZzZp

#29
Windows_PowerShell_Logic7
Count the number of unique words in words.txt
**Note: File Location - C:\Users\CTF\Desktop\CTF
(get-content words.txt | sort-object | get-unique).count
456976

#30
Windows_PowerShell_Basics_9
How many methods are available for the get-process cmdlet?
Machine: Admin_Station
(get-process | get-member -membertype method).count

#31
Windows_Powershell_Logic_8
Count the number of folders in the Music folder in the CTF user’s profile.
(get-childitem -recurse | where-object {$_.PSIsContainer}).count
411

#32
Windows_PowerShell_Regex_2
Count the number of times, case-insensitive, gaab is listed in words.txt **Note: File Location - C:\Users\CTF\Desktop\CTF
(get-content words.txt | select-string -allmatches "gaab").count
1

#33
Windows_PowerShell_Regex_3
Count the number of words, case-insensitive, with either a or z in a word, in the words.txt file
Note: File Location - C:\Users\CTF\Desktop\CTF
(get-content words.txt | where-object { $_ -match '(a|z)'}).count
160352

#34
Windows_PowerShell_Regex_4
Count the number of lines, case-insensitive, that a or z appears in the words.txt file
Note: File Location - C:\Users\CTF\Desktop\CTF
(get-content words.txt | where-object { $_ -match '(az)'}).count
2754

#35
Windows_PowerShell_Logic_9
Use a PowerShell loop to unzip the Omega file 1,000 times and read what is inside.
Note: Make sure you back up the .zip file to a different directory before attempting this challenge.
for($i=1000;$i -gt 0; $i--){expand-archive -path ".\omega${i}.zip";mv "omega${i}\omega$($i-1).zip"}
expand-archive .\omega1.zip
cd omega1
expand-archive.\omega1.zip
cd omega1
get-content .\omega1.txt
kung-fu

#36
Windows_PowerShell_Regex_5
Count the number of words in words.txt that meet the following criteria:
a appears at least twice consecutively
and is followed immediately by any of the letters a through g
Note: File Location - C:\Users\CTF\Desktop\CTF
Example: aac...aaa...
(get-content words.txt | where-object { $_ -match '((aa)[a-g])}).count
357

###############################END###############################
###############################POWERSHELL_PROFILES###############################
#1
Windows_PowerShell_Profiles1
Which PowerShell profile has the lowest precedence?
Current User, Current Host


#2
Windows_PowerShell_Profiles2
Which PowerShell profile has the highest precedence?
All Users, All Hosts

#3
Windows_PowerShell_Profiles3
Which PowerShell variable stores the current user’s home directory?
$HOME

#4
Windows_PowerShell_Profiles4
Which PowerShell variable stores the installation directory for PowerShell?
$PsHome

#5
Windows_PowerShell_Profiles5
Which PowerShell variable stores the path to the "Current User, Current Host" profile?
$Profile

#6
Windows_PowerShell_Profiles6
What command would you run to view the help for PowerShell Profiles?
get-help about_profiles

#7
Windows_PowerShell_Profiles7
What command would tell you if there was a profile loaded for All Users All Hosts?

Flag is the full command syntax
test-path -path $PROFILE.AllUsersAllHosts
#8



###############################END###############################
##############################################################END OF DAY 1##############################################################
##############################################################DAY 2##############################################################
###############################REGISTRY PRIMER###############################
#1
Primer_Registry_1
What Windows registry path is the Volatile Hive?
HKLM\HARDWARE

#2
Primer_Registry_2
What registry key creates the Wow6432Node to represent 32-bit applications that run on a 64-bit version of Windows?
HKEY_LOCAL_MACHINE\SOFTWARE


#3
Primer_Registry_3
In what registry path are the BOOT_START drivers located?
HKLM\SYSTEM\CurrentControlSet\Services

#4
Primer_Registry_4
What start value do BOOT_START drivers have in the registry?
0x0


#5
Primer_Registry_5
During kernel initialization, what registry location is read containing all SYSTEM_START drivers?
HKLM\SYSTEM\CurrentControlSet\Services


#6
Primer_Registry_6
SERVICE_AUTO_START drivers and services are loaded after kernel initialization. What start value do they have in the registry?
0x02


#7
Primer_Registry_7
What start value do SERVICE_DEMAND_START drivers and services have in the registry?
0x3

#8
Primer_Registry_8
When accessing a remote registry which are the only 2 accessible HKEYs?
SYNTAX Hive, Hive
HKLM, HKU

#9
Primer_Registry_9
What PowerShell cmdlet will list currently mapped drives?
get-psdrive


#10
Primer_Registry_10
What is the native Windows GUI tool for managing the registry?
regedit

###############################END###############################
###############################REGISTRY###############################
#1
Windows_Registry_Basics_1
What registry hive contains all machine settings?
HKLM

#2
Windows_Registry_Basics_2
What registry hive contains all user settings?
HKU

#3
Windows_Registry_Basics_3
What registry hive contains only the currently logged-in user's settings?
HKCU

#4
Windows_Registry_Basics_4
The HKEY_CURRENT_USER registry hive is a symbolic link to another registry subkey. What is the subkey that it is linked to?
Flag format: HIVE\SID.........................
Reminder: All challenges are done using Workstation2.
reg query HKU
HKEY_USERS\S-1-5-21-2881336348-3190591231-4063445930-1002

#5
Windows_Registry_Basics_5
What PowerShell command will list all the subkeys and contents in the current directory and/or will list all the subkeys and 
the contents of a directory you specify?
get-childitem


#6
Windows_Registry_Basics_6
What PowerShell command will list only the contents of a registry key or subkey?
get-item


#7
Windows_Registry_Basics_7
What registry subkey runs every time the machine reboots? The flag is the full path, using PowerShell.
Flag format: FULL\PATH\ALL\CAPS
HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUN


#8
Windows_Registry_Basics_8
What registry subkey runs every time a user logs on? The flag is the full path, using PowerShell.
Flag format: FULL\PATH\ALL\CAPS
HKEY_CURRENT_USER\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUN


#9
Windows_Registry_Basics_9
What registry subkey runs a single time, then deletes its value once the machine reboots? The flag is the full path, using PowerShell.
Flag format: FULL\PATH\ALL\CAPS
HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUNONCE


#10
Windows_Registry_Basics_10
What registry subkey runs a single time, then deletes its value when a user logs on? The flag is the full path, using PowerShell.
Flag format: FULL\PATH\ALL\CAPS
HKEY_CURRENT_USER\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUNONCE


#11

#12

#13

#14

#15

#16

#17

###############################END###############################
###############################NTFS PRIMER###############################
#1
Primer_NTFS_1
The ____ determines how the data is stored on disk.
format

#2
Primer_NTFS_2
What are NTFS partition sectors grouped into?
cluster


#3
Primer_NTFS_3
What contains the metadata about all of the files and directories on a NTFS partition?
MFT

#4
Primer_NTFS_4
NTFS files are collections of what?
attributes

#5
Primer_NTFS_5
Which NTFS attribute would store an alternate data stream?
$DATA


#6
Primer_NTFS_6
Which NTFS attribute holds information about a file's encrypted attributes?
$LOGGED_UTILITY_STREAM

#7
Primer_NTFS_7
Which NTFS attribute that is composed of the file security and access control properties?
$SECURITY_DESCRIPTOR

#8
Primer_NTFS_8
In NTFS, what is the type id, in hex, of the attribute that actually stores a NTFS files contents?
0x80

#9
Primer_NTFS_9
In NTFS what is the maximum number of bytes a MFT entry (containing the entirety of a file) 
can contain to be considered "Resident Data"?
1024

#10
Primer_NTFS_10
NTFS permissions can be a assigned to a filesystem object in two ways. Which way is intentionally assigned on the file or folder?
explicit

#11
Primer_NTFS_11
NTFS permissions can be a assigned to a filesystem object in two ways. Which way is the results of an object being assigned permissions
as the result of being the child of another object?
inherited

#12
Primer_NTFS_12
Which NTFS file level permission is missing from the following list? Write, Read & Execute, Modify, Full Control
read

#13
Primer_NTFS_13
Which NTFS folder level permission is missing from the following list?: Read, Write, Read & Execute, Modify, Full control
List Folder Contents

#14
Primer_NTFS_14
Which NTFS file level permission permits changing the contents of a file, deleting the file but does not allow the ability to change the permissions on the file?
modify

#15
Primer_NTFS_15
Which NTFS folder level permission allows changing permissions?
full control

#16
Primer_NTFS_16
Which NTFS attribute stores the file times of an object?
$STANDARD_INFORMATION

#17
Primer_NTFS_17
What CLI command will only show the letters of attached drives? **Hint command is 3 words
fsutil fsinfo drives
###############################END###############################
###############################NTFS###############################

#18
Windows_File_System_Basics_1
Every file on a Windows system has attributes. What does the d attribute mean?
directory

#19
Windows_File_System_Basics_2
Every file on a Windows system has attributes. What does the h attribute mean?
hidden

#20
Windows_File_System_Basics_3
What PowerShell command will list all files in the current directory, regardless of their attributes?
get-childitem -force

#21
Windows_File_System_Basics_4
What PowerShell command will give you the sha512 hash of a file?
Flag format: command -argument
get-filehash -algorithm sha512

#22
Windows_File_System_Basics_5
What PowerShell command will list permissions of a file?
get-acl

#23
Windows_File_System_Basics_6
What Windows file maps hostnames to IP addresses?
hosts

#24

#25

#26

#27

#28

#29

#30

#31


###############################END###############################
##############################################################END OF DAY 2##############################################################
##############################################################DAY 3##############################################################
###############################LINUX BASICS###############################
#1
Linux Basics Reformat0
This challenge is worth 0 POINTS, and should only be attempted after all other challenges that are open to you, are completed!

File: /home/garviel/NMAP_all_hosts.txt

Format the file into the output displayed below using native Linux binaries like awk.


Service: ident Count: 1
==============================
192.168.33.236

Service: IIS Count: 3
==============================
192.168.33.205
192.168.33.227
192.168.33.229

--TRIMMED--
Present the script used to the instructor for credit when complete. Be prepared to explain the code.

HINT: awk is a powerful text manipulation scripting language. It is a bit challenging to learn. Use the tutorials below to get started.

Awk - A Tutorial and Introduction - by Bruce Barnett

The GNU Awk User’s Guide



#2
Linux Basics 1
What command lists the contents of directories in Linux/Unix systems?
ls

#3
Linux Basics 2
For the ls command, what arguments, or switch options, will allow you to print human-readable 
file sizes in a long-list format?
The flag is entire command, including arguments
ls -lh

#4
Linux Basics 3
What character will pipe the standard output from
echo "I’m a plumber"
to another command, as standard input?
|

#5
Linux Basics 4
What argument/switch option, when used with man, will search the short descriptions and man-page-names for a 
keyword that you provide?
The flag is the complete command, with argument/switch.
man -k

#6
Linux Basics LFS Hierarchy
What is the absolute path to the root directory?
/

#7
Linux Basics LFS Hierarchy2
What is the absolute path to the default location for configuration files?
/etc

#8
Linux Basics LFS Hierarchy3
What is the directory that contains executable programs (binaries) which are needed in single user mode, 
to bring the system up or to repair it?
/bin

#9
Linux Basics LFS Hierarchy4
What is the absolute path to the directory which contains non-essential binaries that are accessible 
by standard users as well as root?
/usr/bin


#10
Linux Basics LFS Hierarchy5
An absolute path to a directory which contains binaries only accessible by the root user, or 
users in the root group.
/usr/sbin

#11
Linux Basics LFS Hierarchy6
What is the absolute path for the binary cat man-page?
man --path cat
/usr/share/man/man1/cat.1.gz

#12
Linux Basics 5
Search the man pages for the keyword digest. 
Then, use one of the binaries listed to hash the string OneWayBestWay using the largest sha hash available.
The resulting hash is the flag.
man-k digest
man -k digest
echo "OneWayBestWay" | sha512sum
a81bc463469ee1717fc9e388e3799c653f63a3de5e9496b5707b56488b046cbf75665235d316c5c0053a597dc7d40c917a2d9006fe35e9cb47766c05ac71989b
#13
Linux Basics 6
Use File: /home/garviel/Encrypted
This file contains encrypted contents. Identify its file type, then decode its contents.
Hint: Use OpenSSL
Research: https://www.openssl.org/docs/man1.1.1/man1/enc.html
Reminder: All challenges are done using the Terra box.

#14
Linux Basics LFS Hierarchy7
Search the user home directories to find the file with the second-most lines in it. 
The flag is the number of lines in the file.
Hint: Exclude the VDI file!
find $HOME/* -type f -exec wc -l {} + | sort -rn
20000

#15
Linux Basics Users and Groups1
Read the file that contains the user database for the machine. Identify a strange comment.
awk -F: '$3 >= 1000 && $3 != 65534 { printf "%s -- %s\n",$1,$5;}' /etc/passwd
Traitor

#16
Linux Basics Users and Groups2
Identify all members of the lodge group. List their names in alphabetical order with a comma in between each name.
Flag Format: name,name,name
cat /etc/group | grep lodge | cut -d : -f 4
#put in alphabetical order
garviel,tarik,aximand,ezekyle,sejanus,erebus

#17
Linux Basics Users and Groups3
Find the user with a unique login shell.
cut -d ':' -f 7 /etc/passwd | sort -u
cat /etc/passwd | grep /bin/sh
nobody

#18
Linux Basics Users and Groups4
Identify the algorithm, the amount of salted characters added, and the length of the hashed password 
in the file that stores passwords.
Hint: Research 'padding'...
Flag format: algorithm,#characters,#length

#19
Linux Basics Permissions1
Find the directory named Bibliotheca. Enter the absolute path to the directory.
find / -type d -name 'Bibliotheca' 2> /dev/null
/media/Bibliotheca

#20
Linux Basics Permissions2
Identify the number of users with valid login shells, who can list the contents of the Bibliotheca directory.
cat /etc/passwd | grep -v nologin | grep -v false | grep -vc sync
15

#21
Linux Basics Permissions3
The permissions that user sejanus has on /media/Bibliotheca, in octal format.
Flag format: #
HINT: Think about groups...
stat -c "%a" /media/Bibliotheca
755
#22
Linux Basics Permissions 4
Locate the file within /media/Bibliotheca that is modifiable by the only user that is part of the chapter group,
but not part of the lodge group.
Hint: Not the hidden file...


#23
Linux Basics Permissions 5
Identify the file within /media/Bibliotheca where the owning group has more rights than the owning user.


#24
Linux Basics Permissions 6
Execute the file owned by the guardsmen group in /media/Bibliotheca, as the owning user.
The flag is the code name provided after a successful access attempt.
Hint: Remember your sudo options.
ls -lisa -R /media/Bibliotheca | grep guardsmen
find /media/Bibliotheca -type f -name "Codex_Imperium" 2> /dev/null
sudo cat /media/Bibliotheca/Bibliotheca_quattuor/Tactica_Imperium
GHOSTS

#25
Linux Basics Permissions 7
The user tyborc is unable to access the directory:
/media/Bibliotheca/Bibliotheca_unus
Why? Identify the permission missing in standard verb form.
ls -lisa <parent directory>
execute

#26
Linux Basics Permissions 8
You only have a single submission attempt for this challenge.
Locate the file in /media/Bibliotheca that Quixos has sole modification rights on.
The flag is the absolute path for the file, include the file name.


#27
Linux Basics Permissions9
Read a concealed file within /media/Bibliotheca
find /media/Bibliotheca -type f -name ".*" 2> /dev/null
cat /media/Bibliotheca/Bibliotheca_duo/.Secrets_of_the_Immaterium
expand your mind

#28
Linux Basics Permissions10
Find the warp and read its secrets for the flag.
cat /media/Bibliotheca/Bibliotheca_duo/.warp2/.warp5/warp5/.warp3/warp2/.secrets
Ph'nglui mglw'nafh Cthulhu

#29
Linux Basics Regular Expressions1
Using the commands ls and grep, identify the number of directories in /etc/ that end in .d
find /etc -name *.d -type d -maxdepth 1 2>/dev/null | wc -l
28

#30
Linux Basics Regular Expressions2
File: home/garviel/numbers
Use regular expressions to match patterns similar to valid and invalid IP addresses.
The answer is the count/number of lines that match in the file.
cat /home/garviel/numbers 
grep '^[0-9]\{1,3\}\.[0-9]\{1,3\}\.[0-9]\{1,3\}\.[0-9]\{1,3\}$' numbers | wc -l
78


#31
Linux Basics Regular Expressions3
File: home/garviel/numbers

Use regular expressions to match valid IP addresses. The flag is the number of addresses.

HINT: What are the valid numerical values of each octet in an IP address?


'^((25[0-5]|(2[0-4]|1\d|[1-9]|)\d)\.?\b){4}$'

#32
Linux Basics Regular Expressions4
File: home/garviel/numbers
Use regular expressions to match patterns that look similar to a MAC Address. Flag is a count of the number of matches.
HINT: This is a loose match! Some of these results won't be true MAC addresses.
Flag format: ####


#33
Linux Basics Reformat1
File: home/garviel/numbers
Use awk to print lines:
>= 420 AND <=1337
The flag is a SHA512 hash of the output.


#34
Linux Basics Reformat2
File: home/garviel/connections

Use awk to create a separate CSV (comma separated value) file that contains columns 1-6.
The flag is an MD5 hash of the new file
Hint: Look at #fields on line 6 in the file to understand column layout.
Hint: This is a Zeek (formally known as Bro) connection log file in TSV format. 
Click This Link to learn about its formatting.
Sample Output
#separator \x09,,,,,
#set_separator,,,,,,
#empty_field,(empty),,,,
#unset_field,-,,,,
#path,conn,,,,
#open,2021-03-09-14-26-54,,,,
#fields,ts,uid,id.orig_h,id.orig_p,id.resp_h
#types,time,string,addr,port,addr
1615299704.748741,Cynd96jpqm760uz0k,192.168.242.216,60508,192.168.65.20,22
1615299962.756967,CFWnz12Wd2cXj3iSIe,fe80::c95c:6e92:5618:9df7,546,ff02::1:2,547
1615300118.087124,CuVCPTMljpoBDEuR1,192.168.65.10,62117,10.50.255.254,53
--- Trimmed ---


#35
Linux Basics Bash Logic1
Directory: home/garviel/Battlefield/
The garviel user has a minefield map and controls to a Titan War Machine located in their home directory. 
Interpret the Titan Controls to navigate the minefield and annihilate the target.
Enter the correct movement codes to make the Titan obliterate the target.
Format: XXX3X2X......


#36
Linux Basics Bash Logic2
The flag resides in $HOME/paths... you just need to determine which flag it is. 
The flag sits next to a string matching the name of a $PATH/binary on your system.
Hint: The correct binary is not echo
Hint: Compare the contents


#37
Linux Basics Regular Expressions5
File: home/garviel/numbers
Use regular expressions to find valid Locally Administered or Universally Administered Unicast MAC addresses.
Give the count of Locally and Universally Administered MAC addresses as the answer.
HINT: What characters specifically define a Locally or Universally Administered Unicast MAC Address?


#38
Linux Basics Bash Logic3
FILE: /home/garviel/Inquisition_Targets
Identify heresy by comparing the Inquisition_Targets file to members of the Guardsmen group.
HINT: Reformat and clean up the data before it is compared. awk and sort are your best friends!
The flag is the number of heretics on the system.



###############################END###############################
###############################BLANK###############################
#1
#2
#3
#4
#5
#6
#7
#8
#9
#10
#11
#12
#13
#14
#15
#16
#17
#18
#19
#20
###############################END###############################
###############################BLANK###############################
#1
#2
#3
#4
#5
#6
#7
#8
#9
#10
#11
#12
#13
#14
#15
#16
#17
#18
#19
#20
###############################END###############################
##############################################################END OF DAY 3##############################################################
##############################################################DAY 4##############################################################
###############################07_windows_boot_process###############################
#1
Primer_Boot_Process_1
What is the smallest addressable unit on a hard disk?
sector

#2
Primer_Boot_Process_2
What term describes a logical division of a single storage device?
partition

#3
Primer_Boot_Process_3
What term describes a formatted storage device that can span 1 or more partitions, has a single file system and is assigned a drive letter?
volume

#4
Primer_Boot_Process_4
What CLI disk partitioning tool is available in Windows to view and manipulate both partitions and volumes?
diskpart

#5
Primer_Boot_Process_5
Windows includes 4 critical Kernel-mode components. 
Which component is a matched pair with the kernel and obfuscates the hardware dependencies from the kernel?
HAL

#6
Primer_Boot_Process_6
Windows includes 4 critical Kernel-mode components. 
Which component directs calls from a user-mode process to the kernel services?
executive

#7
Primer_Boot_Process_7
This provides an operating system with a software interface to a hardware device
driver

#8
Primer_Boot_Process_8
What are the two firmware interfaces supported by modern computers and read in the Pre-boot phase of the 
Windows boot process?
**Hint, answer format = _______ and _______
UEFI and BIOS

#9
Primer_Boot_Process_9
What is the name of the process that spawns SYSTEM?


#10
Primer_Boot_Process_10
In Windows what does the boot sector code load into memory?
**Hint - Flag Format = ________ and ________


#11
Primer_Boot_Process_11
In Windows 10 what is the name of the boot manager?
bootmgr


#12
Primer_Boot_Process_12
In Microsoft Vista and later the boot.ini file was replaced by what?
BCD

#13
Primer_Boot_Process_13
What is the tamper-resistant processor mounted on the motherboard used to improve the security of your PC. 
It's used by services like BitLocker drive encryption and Windows Hello to securely create and store 
cryptographic keys, and to confirm that the operating system and firmware on your 
device are what they're supposed to be, and haven't been tampered with.
TPM


#14
Primer_Boot_Process_14
During the Windows boot process, what starts BOOT_START device drivers and services with value 
of 0x0 in the registry key HKLM\SYSTEM\CurrentControlSet\Services?
winload.exe

#15
Primer_Boot_Process_15
During the Windows boot process, what starts SYSTEM_START device drivers and services with hex value of 
0x1 in the registry key HKLM\SYSTEM\CurrentControlSet\Services?
NTOSKRNL.exe

#16
Primer_Boot_Process_16
During the Windows boot process, services.exe starts device drivers and services on demand with what 
hex value in the registry key HKLM\SYSTEM\CurrentControlSet\Services?
hint syntax - #x#
0x0

#17
Primer_Boot_Process_17
Starting in Windows Vista, what process spawns two additional instances (with identical names), 
used to initiate session 0 and session 1?
smss.exe


#18
Primer_Boot_Process_18
Which Windows Vista user session is non-interactive, contains system services and processes and is 
isolated from the GDI (Graphical Device Interface)
Session 0

#19
Primer_Boot_Process_19
What is the boot process security feature available in UEFI systems, that only allows verified drivers to load?
secure boot

#20
Primer_Boot_Process_20
To make booting faster, starting with Windows 8, the OS does a partial ________ of the kernel session at shutdown?
hibernation

#21
Primer_Boot_Process_21
What registry key is responsible for starting services on your machine during the boot process? 
Flag is the full registry path.
HKLM\Software\Microsoft\Windows\CurrentVersion\RunServices

#22
Primer_Boot_Process_22
When a user logs on to a Windows host, authentication will either grant the user access to the local 
computer only (Local Logon) or the user will also be granted access to a Windows domain (Domain Logon). 
Which logon will the user be authenticated to via the Security Accounts Manager (SAM) database?
local logon

#23
Primer_Boot_Process_23
What is the parent process of explorer.exe?
Userinit

#24
Primer_Boot_Process_24
What is responsible for handling Windows SAS (secure attention sequence), user profile loading, 
assignment of security to user shell, and Windows station and desktop protection?
Winlogon

#25
Primer_Boot_Process_25
What critical Windows process is initialized by wininit.exe, is responsible for creating the user's security 
access token and verifying user logon credentials?
LSASS

#26
Primer_Boot_Process_26
What Microsoft recovery option overwrites the registry key HKLM\System\Select after every successful logon?
Last Known Good Configuration

#27
Primer_Boot_Process_27
What authentication protocol is the default for logging onto an Active Directory domain and features SSO 
(Single-Sign On), mutual authentication and primarily uses symmetric cryptography?
Kerberos

#28
Primer_Boot_Process_28
In Kerberos the Active Directory controller serves as which major Kerberos component consisting of the Authentication Service (AS) and the Ticket Granting Service (TGS)
KDC  #Key Distribution Center

#29
Primer_Boot_Process_29
When would the following Windows registry keys, actions occur? 
HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Userinit HKLM\Software\Microsoft\Windows 
NT\CurrentVersion\Winlogon\Shell HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify
logon


#30
Primer_Kernel_1
The Windows NT Operating System attempts to combine features and benefits of microkernel and monolithic 
kernel architectures, making it which type of kernel architecture?
hybrid

#31
Primer_Kernel_2
The Linux kernel is an example of what type of kernel architecture?
monolithic

#32
Primer_Kernel_3
Windows operating system name typically differs from its version number. 
Which Windows version includes Windows 7 and Windows Server 2008R2 and was the 1st version to ship with PowerShell?
**hint - only give the version number
6.1

#33
Primer_Kernel_4
Which Windows version includes Windows Server 2016, 2019, 2022, Windows 10 & 11 and includes SMB 3.1.1 support?
Research: https://learn.microsoft.com/en-us/windows/win32/sysinfo/operating-system-version
10



#34
Primer_Kernel_5
The CMD.EXE tool systeminfo included in Windows is very similar to msinfo32 and displays 
operating system configuration version information for a local or remote machine, including service pack levels.

Craft a systeminfo command that only returns the below info:
OS Version: "System OS and Build #"
BIOS Version: "Your BIOS Ver"

The Flag is the full command.
Research: https://ss64.com/nt/systeminfo.html


#35
Windows_Boot_Init_1
What is the first process to spawn on Windows systems after the kernel loads?


#36
Windows_Boot_Init_2
What is the Process ID (PID) of the first Windows process?
4

#37
Windows_Boot_Init_3
What is the second boot process to spawn, that then spawns csrss in both session 0 and session 1?
smss.exe

#38
Windows_Boot_Init_4
What session ID do Windows services operate in?
0

#39
Windows_Boot_Init_5
What process creates access tokens?
LSASS

#40
Windows_Boot_Init_6
What is the parent process to all svchosts?
services.exe

#41
Windows_Boot_Init_7
What process is waiting with high priority for the Secure Attention Sequence (SAS)?
winlogon

#42
Windows_Boot_Init_8
What user space process spawns explorer, then dies?
Userinit

#43
Windows_Boot_Init_9
What is the name of the bootloader, with extension, we are using on all of the Windows machines in this environment?
winload.exe

#44
Windows_Boot_Init_10
Challenge only allows ONE attempt

Based on the boot loader from Init_9, which firmware are we using (BIOS or UEFI) in our environment?
BIOS

#45
Windows_Boot_Init_11
What file saves the memory state to the hard drive when going into hibernation?
Hiberfil.sys

#46
Windows_Boot_Init_12
What bootloader is responsible for restoring the system to its original state after hibernation?
Winresume.exe

#47
Windows_Boot_Remediate_1
The system is booting into safe mode. Identify the flag from the command-line output of the command 
used to diagnose boot issues.

Follow these instructions to boot the virtual image -- Click Here ---> Windows Bootkit Instructions
bcdedit
description  Flag: 1RF5Zgf9P

#48
Windows_Boot_Remediate_2
The system is booting into safe mode. Correct that, and reboot into the desktop. The flag is on the desktop.

Follow these Windows Bootkit Instructions to boot the virtual image
bcdedit /deletevalue {default} safeboot
shutdown /r
shutdown -a    #run until it aborts the shutdown
76Drp6hB

#49
Windows_Boot_Remediate_3
Prevent the system restart using the command line, and then identify persistence mechanisms that are reverting the OS and boot loader configurations.

The flag is in the same folder as the persistence mechanism.

HINT: Copy the error message in its entirety to figure out what is happening to the system.

WARNING: You have 30 seconds to comply.

Follow these Windows Bootkit Instructions to boot the virtual image

C:\Users\Yang\AppData\Roaming\Microsoft\Internet Explorer\uic Launch\User Pinned\Taskbar\Windows Powershell.lnk

#50

#51

###############################END###############################

##############################################################END OF DAY 4##############################################################
##############################################################DAY 5##############################################################
###############################LINUX BOOT###############################
#1
Linux Boot Hex1
Solve the following equation:

0x31A - 0x21B

Enter the flag in Hexadecimal form.

0xFF

#2
Linux Boot Bits and Bytes 1
How many bits are in a nibble, and a byte?

Flag format: #,#
4,8

#3
Linux Boot Bits and Bytes 2
How many bits does a single Hexadecimal character represent?
4

#4
Linux Boot Bits and Bytes 3
Each hex pair contains a value of 8 bits when used to represent memory. The range from 0x00000000 to 0x00000010 in hexadecimal represents addresses in memory or positions in data. This range includes the starting address (0x00000000) and ends at the address (0x00000010).

How many bytes could the range 0x00000000 - 0x00000010 contain?


#5
Linux Boot MBR 1
How large is the Master Boot Record and what directory is it located in?

Flag format: #InBytes,fullpathdirectory


#6
Linux Boot SysV 1
Identify which of your Linux machines is using SysV Initialization.
Minas_Tirith

#7
Linux Boot Hex2
What are the maximum and minimum value a single Hexadecimal digit can contain?

Enter the values in Linux Hexadecimal Numerical Constant form.

Flag format: min-max


#8
Linux Boot Hex3
What are the maximum and minimum values, in decimal notation, that a single Hexadecimal digit can represent?

Flag format: min-max
0-15

#9
Linux Boot Hex4
Solve the following equation:

0x31A + 0x43

Enter the flag in Hexadecimal form.
0x35D

#10
Linux Boot Bits and Bytes 4
Execute : sudo cat /dev/vda | xxd -l 32 -c 0x10 -g 1

What are the values contained in hex positions 0x00000001 through 0x00000008?

Flag format: Value,Value,Value,...

Machine: For this challenge: Minas_Tirith (ssh from Admin_Station)
63, 90, 8e, d0, 31, e4, 8e, d8

#11
Linux Boot MBR 2
Locate the master boot record for one of the Linux machines and read it with xxd

What programming language is the MBR written in?

HINT: Look at the first three bytes
assembly language

#12
Linux Boot MBR3
The file /home/bombadil/mbroken is a copy of an MBR from another machine.

Hash the first partition of the file using md5sum. The flag is the hash.

xxd -l 120 -ps -c 20 xxd.1

dd -ibs 16 

dd bs=1 skip==446 count=16 if=mbroken of=linuxsucks
md5sum linuxsucks
2a5948fad4ec68170b23faaa2a16cef8

#13
Linux Boot MBR4
The file /home/bombadil/mbroken is a copy of an MBR from another machine.

You will find the "word" GRUB in the output, hash using md5sum.

The flag is the entire hash.
dd bs=1 skip=392 count=4 if=mmbroken of=linuxsucks
md5sum linuxsucks
5fa690cb0f0789cbc57decfd096a503e

#14
Linux Boot MBR5
The file /home/bombadil/mbroken is a copy of an MBR from another machine.

Hash only the Bootstrap section of the MBR using md5sum. The flag is the entire hash.


#15
Linux Boot SysV 2
Identify the default run level on the SysV Init Linux machine.

Flag format: #
2

#16
Linux Boot SysV 3
What is the last script to run when the command init 6 is executed?

Flag format: /absolute/path

NOTE: “Use the Minas_Tirith machine for this question.”


#17
Linux Boot SysV 4
What run levels start the daemon that allows remote connections over port 22?

Flag format: #,#,#,#

NOTE: Use the Minas_Tirith machine for this question.
cat /etc/inittab
2,3,4,5

#18
Linux Boot Systemd 1
Identify the file that init is symbolically-linked to, on the SystemD init machine.

Flag format: /absolute/path

Reminder: Use your Terra machine for these SystemD challenges!


#19

#20

#21

#22

#23

#24

###############################END###############################
##############################################################END OF DAY 5##############################################################
##############################################################DAY 6##############################################################
###############################Windows Process Validity###############################
#1
Primer_Processes1
What is the full path to folder used when Windows redirects 32 bit applications running on a 64bit system?
C:\Windows\SysWOW64	

#2
Primer_Processes2
What Windows System Service starts the kernel and user mode subsystems?
smss.exe

#3
Primer_Processes3
What Windows system process:

Runs in session 0
is responsible for enforcing the security policy on the system
Performs all logon functions
Handles password changes
Creates access tokens
Writes to the Windows Security Log

LSASS

#4
Primer_Processes4
Which is spoolsv.exe?


#5
Primer_Processes5
Which service type is explorer.exe?


#6
Primer_Processes6
During a network survey you observed a host running inetinfo.exe service. What type of server might you have found?
IIS    #Internet Information Server 

#7
Primer_Processes7
During a reconnaissance mission you enumerated a host running the dns.exe service. Is this a user pc or a server?
server

#8
Primer_Processes8
A host running firefox and office 365 is most likely what type of host? Server or Client
client

#9
Primer_Processes9
How does a User-Mode Service request resources?
System Call

#10
Primer_Processes10
Passively copying currently running processes for comparison later is known as?
baselining

#11
Primer_Processes11
What can execute any part of a processes code, to include parts already being executed?
thread

#12
Primer_Processes12
Windows has how many process priority levels?
32

#13
Windows_Processes_Basics_1
What Sysinternals tool shows malware persistence locations in tabs within its GUI?
autoruns

#14
Windows_Processes_Basics_2
What Sysinternals tool is used to investigate processes?
procexp

#15
Windows_Processes_Basics_3
What Sysinternals tool can be used to investigate network connection attempts?
tcpview

#16
Windows_Processes_Basics_4
What Sysinternals tool can view permissions?
AccessChk

#17
Windows_Processes_Basics_5
What Sysinternals tool allows us to view and modify handles?
Handle

#18
Windows_Processes_Basics_6
What is the default Windows user directory for files downloaded from the internet? The flag is the folder name only.
Downloads

#19
Windows_Processes_Basics_7
What is the default Windows download directory that everyone has access to? The flag is the absolute path to the directory.
C:\users\public\downloads

#20
Windows_Processes_Basics_8
What Sysinternals tool shows service load order?
LoadOrder

#21
Windows_Processes_Basics_9
What is the service name of Windows Defender Firewall?
MpsSvc

#22
Windows_Processes_Basics_10
What SysInternals tool reports .dlls loaded into processes?
ListDLLs

#23
Windows_Hidden_Processes_1
There is malware on the system that is named similarly to a legitimate Windows executable. There is a .dll in the folder that the malware runs from. The flag is the name of the .dll.
Reminder: All challenges are done using Workstation1.


#24

#25

#26

#27

#28

#29

#30

#31

#32

#33

#34

#35

#36

###############################END###############################
###############################Windows UAC###############################
#1
Windows_UAC_Basics_1
What Sysinternals tool will allow you to view a file's manifest?
Sigcheck

#2
Windows_UAC_Basics_2
What is the RequestedExecutionLevel for an application to run with the same permissions as the process that started it?
asInvoker

#3
Windows_UAC_Basics_3
What RequestedExecutionLevel will prompt the user for Administrator credentials if they're not a member of the Administrator's group?
requireAdministrator


#4
Windows_UAC_Basics4
What registry key holds UAC values?
HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System

#5

#6

#7

#8

###############################END###############################
###############################Windows Services###############################
#1
Windows_Services_Basics_1
What command-line (cmd) command will show service information?
sc query

#2
Windows_Services_Basics_2
What command-line (cmd) command will show all services, running or not running?
The flag is the full command, for all services.
sc queryex type=service state=all

#3
Windows_Services_Basics_3
What PowerShell command will list all services?
Get-service

#4
Windows_Services_Basics_4
What registry location holds all service data?
HKLM\System\CurrentControlSet\Services

#5
Windows_Services_Basics_5
What registry subkey holds a service's .dll location?
The flag is the subkey name (full path not needed).
Parameters

#6

#7

###############################END###############################
##############################################################END OF DAY 6##############################################################
##############################################################DAY 7##############################################################
###############################Linux Process Validity###############################
#1
Linux Processes 1
What is the process ID (PID) of the SysV Init daemon?
1

#2
Linux Processes 2
How many child processes did SysV Init daemon spawn?
htop
#sort by ppid
#count
24

#3
Linux Processes 3
Identify all of the arguments given to the ntpd daemon (service) using ps.
Format: List all options with parameters (include numbers).
ps -elf | grep ntpd
-p /var/run/ntpd.pid -g -u 105:109

#4
Linux Processes 4
What is the parent process to Bombadil’s Bash process? (name of the binary, not the absolute path)
sshd

#5
Linux Processes 5
Identify the file mapped to the fourth file descriptor (handle) of the cron process.
HINT: There might be multiple cron processes, but only one with the answer.
Flag format: /absolute/path
sudo lsof | grep cron | sort
COMMAND     PID   TID       USER   FD      TYPE             DEVICE SIZE/OFF       NODE NAME
cron       1336             root    3u      REG               0,19        5      11398 /run/crond.pid
/run/crond.pid

#6
Linux Processes 6
Identify the permissions that cron has on the file identified in Processes 5.
HINT: Read the man page for lsof to understand permissions.
Flag format: If more than one, list the permissions comma separated, no spaces
sudo lsof | grep cron | sort | head
COMMAND     PID   TID       USER   FD      TYPE             DEVICE SIZE/OFF       NODE NAME
cron       1336             root    3u      REG               0,19        5      11398 /run/crond.pid
ls -l /run/crond.pid
-rw-r--r-- 1 root root 5 Aug  5 02:12 /run/crond.pid
r,w

#7
Linux Processes 7
dentify the names of the orphan processes on the SysV system.
NOTE: Remember, orphan processes spawn and die periodically. Try monitoring the processes list with top or htop to find them.
Flag format: in alphabetical order with all non-alphabetic characters removed: Name,Name,Name,Name
HINT: Only character names!
htop
Aragorn,BruceWayne,Eowyn,Tolkien

#8
Linux Processes 8
Locate zombie processes on the SysV system.
Identify the zombie processes' parent process.
NOTE: Remember, zombie processes only live until the parent process kills and removes them from the system’s process table. Try monitoring the processes list with top or htop to find them.
Flag format: /absolute/path
htop 
#sort by S
#tree
#watch for zombies
#the last parent that is not a zombie 
/bin/funk



#9
Linux Processes 9
Locate the strange open port on the SysV system.
Identify the command line executable and its arguments.
Flag format: /executable/path -arguments
htop
/bin/netcat -lp 9999


#10
Linux Process Proc Dir 1
Examine the process list to find the ssh process. Then, identify the symbolic link to the absolute path for its executable in the /proc directory.
The flag is the absolute path to the symbolic link, and the file it is linked to.
Flag format: /absolute/path,/absolute/path
ps -elf | grep sshd
ls -l /proc/1904
/proc/1904/exe,/usr/sbin/sshd



#11
Linux Process Proc Dir 2
Identify the file that contains udp connection information. Identify the process using port 123.
For the flag, enter:
Process name
File descriptor number for the udp socket
Its permissions as shown in lsof
Flag format: name,#,permission
sudo lsof | grep UDP 
ntp,17,u

#12
Linux Processes 10
Locate the strange open port on the SysV system.
Identify how the process persists between reboots.
The flag is the absolute path for the file that contains the persistence mechanism, and the configuration option.
HINT: Persistence is defined here
Flag format: filepath,configuration_option

/sbin/cgmanager --daemon -m name=systemd
/bin/netcat -lp 9999

14262 root       20   0 48760  2616  2248 S  0.0  0.1  0:00.00 │  ├─ /usr/sbin/CRON
14268 witch_kin  20   0  4276   740   672 S  0.0  0.0  0:00.00 │  │  └─ /bin/sh -c /home/witch_king/camlindon > /dev/null 2>&1
14274 witch_kin  20   0 11128  2844  2656 S  0.0  0.1  0:00.00 │  │     └─ /bin/bash /home/witch_king/camlindon
14278 witch_kin  20   0 11128  2264  2008 S  0.0  0.1  0:00.00 │  │        └─ /bin/bash /home/witch_king/camlindon
14290 witch_kin  20   0  6300  1700  1584 S  0.0  0.1  0:00.00 │  │           └─ nc -lw10 127.0.0.1 -p 1234
14260 root       20   0 48760  2616  2248 S  0.0  0.1  0:00.00 │  └─ /usr/sbin/CRON
14267 Dunlendin  20   0  4276   736   668 S  0.0  0.0  0:00.00 │     └─ /bin/sh -c /home/Dunlendings/offering > /dev/null 2>&1
14272 Dunlendin  20   0 11124  2776  2580 S  0.0  0.1  0:00.00 │        └─ /bin/bash /home/Dunlendings/offering
14277 Dunlendin  20   0 11128  2256  1996 S  0.0  0.1  0:00.00 │           └─ /bin/bash /home/Dunlendings/offering
14293 Dunlendin  20   0  6300  1584  1464 S  0.0  0.1  0:00.00 │              └─ netcat -w5 127.0.0.1 1234

1964qq

#13
Linux Process Proc Dir 3
Identify one of the human-readable file handles by the other program that creates a zombie process.
NOTE: Remember, zombie processes only live until the parent process kills them. Try monitoring the processes list with top or htop to find them.
The flag is the text from one of the files it reads.
htop
#figure out the process that is making the zombies
 └+ ________Nazgul________
#get the pid
sudo lsof | grep <pid>
#look for the file that meets the proper type.
cat /opt/mysoul
and in the darkness bind them

#14
Linux Process Find Evil 1
Scenario: The Villains group has been chanting offerings to their new leader at regular intervals over a TCP connection.
Task: Identify their method of communication and how it is occurring. Locate the following artifacts: ** The chant/text used by each villain (include spaces) ** The new Lord receiving the offering ** The IP address and port that the offering is received over
Flag format: chant text,new Lord,IP:port
Machine: Minas_Tirith
find / -name *chant*
sudo lsof | grep chant
#output
offering  17496           Balrog    9w      REG              254,1        0     142174 /home/Balrog/chantlock
netcat    17538           Balrog    9w      REG              254,1        0     142174 /home/Balrog/chantlock
sudo lsof | grep offering
sudo cat /home/The_Eye/chant
#output
Mausan ukoul for avhe mubullat goth
htop
# to find /home/witch_king
ls -l /home/witch_king
cat /home/witch_king/camlindon
#output
#!/bin/bash
(
 flock -n 9 || exit 1
 echo "beaconing"
 for i in $(seq 1 5); do nc -lw10 127.0.0.1 -p 1234 2>/dev/null  ; sleep 10; done
 echo "done beaconing"
) 9>/tmp/mylockfile

Mausan ukoul for avhe mubullat goth,witch_king,127.0.0.1:1234


#15
Linux Process Find Evil 2
Scenario: Someone or something is stealing files with a .txt extension from user directories. Determine how these thefts are occurring.
Task: Identify the command being ran and how it occurs.
Flag format: command,how it occurs
Machine: Terra
Hint: Explore persistence mechanisms and services.


#16
Linux Process Find Evil 3
Scenario: Text files are being exfiltrated from the machine using a network connection. The connections still occur post-reboot, according to network analysts.
The junior analysts are having a hard time with attribution because no strange programs or ports are running, and the connection seems to only occur in 60-second intervals, every 15 minutes.
Task: Determine the means of persistence used by the program, and the port used. The flag is the command that allows exfiltration, and the file its persistence mechanism uses.
Flag format: command,persistence
Machine: Terra
systemctl
whatischaos.service
ls -l /lib/systemd/system | grep chaos
cat /lib/systemd/system/whatischaos.service
cat /lib/systemd/system/whatischaos.timer
netcat -lp 3389 < /tmp/NMAP_all_hosts.txt,whatischaos.timer

#17
Linux Process Find Evil 4
Scenario: The web server has been modified by an unknown hacktivist group. Users accessing the web server are reporting crashes and insane disk usage.
Task: Identify the Cyber Attack Method used by the group, and the command running.
Flag format: AttackMethod,command
Machine: Terra
Try not to break your machine on this one...
htop
/bin/apache3 -lp 443
find / -name *apache3* | grep apache3
cat /lib/systemd/system/apache3.service

DOS,/bin/apache3 -lp 443 < /dev/urandom

#18
Linux Process Find Evil 5
Scenario: Analysts have found a dump of commands on the Internet that refer to the Terra machine. The command history for one of the users with an interactive login is being stolen via unknown means. The network analysts can’t find any persistent connections, but notice a spike in traffic on logon and logoff.
Task: Identify how the command history is stolen from the machine.
The flag is the file used to execute the commands, and where they are sent.
Flag format: /absolute/path/to/file,IP:port
Machine: Terra
ls -la
cat .bash_logout
/home/garviel/.bash_logout,12.54.37.8:12000


###############################END###############################
##############################################################END OF DAY 7##############################################################
##############################################################DAY 8##############################################################
###############################Windows Auditing and Logging###############################
#1
Primer_Auditing_1
Logging, Auditing and Monitoring are often confused with each other but are distinctly different. Which term refers to real-time analysis and is often accomplished with a Security Event Information Management system (SIEM)?
Monitoring

#2
Primer_Auditing_2
What term is most appropriate when referring to the process of reviewing log files or other records for specified period?
Auditing

#3
Primer_Auditing_3
"Complete the following path to the Windows System Log which records system events e.g. startup and shutdown: %systemroot%\System32_______________
WinEvt\Logs\System.evtx

#4
Primer_Auditing_4
Which Windows log contains either success or failures and can be configured to record failed logon attempts?
Security

#5
Primer_Auditing_5
"Which Windows account is the only account to have WRITE-APPEND access to Windows event logs?"
System

#6
Primer_Auditing_6
What is parsed in an NTFS object's security descriptor, by the Security Reference Monitor (SRM), to determine if an audit entry will be created in the Windows Security Log?
SACL

#7
Primer_Auditing_7
Which registry key holds the audit policy configuration? **Hint - Give full path
HKEY_LOCAL_MACHINE\SECURITY\Policy\PolAdtEv

#8
Primer_Auditing_8
Which sysinternals tool is used to parse logs?
PsLogList

#9
Windows_Browser_Artifacts_1
What Sysinternals tool will allow you to read the SQLite3 database containing the web history of chrome?
strings.exe

#10
Windows_Recent_Files_1
What is the registry location of recent docs for the current user?
HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs


#11
Windows_Bam_1
Challenge only allows ONE attempt
BAM settings are stored in different registry locations based on the version of Windows 10. What version of Windows 10 is workstation2 running? The answer is the 4 digit Windows 10 release (version) number.
1803

#12
Windows_Last_Access
Figure out the last access time of the hosts file.
Flag format: mm/dd/yyyy


#13
Windows_Prefetch_1
What is the literal path of the prefetch directory?
C:\Windows\Prefetch

#14
Windows_Recycle_Bin_1
In the Recycle Bin, there is a file that contains the actual contents of the recycled file. What are the first two characters of this filename?
get-wmiobject win32_useraccount | select name,sid
$R

#15
Windows_Recycle_Bin_2
In the Recycle Bin, there is a file that contains the original filename, path, file size, and when the file was deleted. What are the first two characters of this filename?
$I

#16
Windows_UserAssist_1
What are the first 8 characters of the Globally Unique Identifier (GUID) used to list applications found in the UserAssist registry key (Windows 7 and later)?
CEBFF5CD

#17
Windows_UserAssist_2
What cipher method are UserAssist files encoded in?
ROT13

#18
Windows_Logs_1
What main Windows log would show invalid login attempts?
Security

#19
Windows_Logs_2
What main Windows log will show whether Windows updates were applied recently?
System

#20
Windows_Logs_3
When reading logs, you may notice ... at the end of the line where the message is truncated. What format-table switch/argument will display the entire output?
Flag format: -argument
-Wrap

#21
Windows_Browser_Artifacts_2
Find the questionable website that a user browsed to (using Chrome), that appears to be malicious. *Note: There are more than one users on the box.
Machine: Workstation2 (ssh from Admin_Station)
get-content 'C:\Users\student\AppData\Local\Google\Chrome\user Data\default\history'
https://www.exploit-db.com

#22
Windows_Recent_Files_2
There is a file that was recently opened that may contain PII.
Get the flag from the contents of the file.
Hint: We're not interested in numbers.
reg query hkcu\software\microsoft\windows\currentversion\explorer\recentdocs
get-item 'Registry::\HKEY_USERS\*\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs\.*'
[System.Text.Encoding]::Unicode.GetString((gp "REGISTRY::HKEY_USERS\*\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs\.txt")."6")
Flag, Found A.


#23

#24

#25

#26

#27

#28

###############################END###############################


##############################################################END OF DAY 8##############################################################





###############################BLANK###############################
###############################END###############################

##############################################################DAY 1##############################################################
##############################################################END OF DAY 1##############################################################


#1
#2
#3
#4
#5
#6
#7
#8
#9
#10
#11
#12
#13
#14
#15
#16
#17
#18
#19
#20
#21
#22
#23
#24
#25
#26
#27
#28
#29
#30
#31
#32
#33
#34
#35
#36
#37
#38
#39
#40
#41
#42
#43
#44
#45
#46
#47
#48
#49
#50







